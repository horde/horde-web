<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!--          Orator: Copyright 2000-2009 The Horde Project.            -->
<!-- Horde Project: http://horde.org/ | Orator: http://horde.org/orator/ -->
<!--          Horde Licenses: http://www.horde.org/licenses/             -->
<html><head>
<title>Presentations</title>
<link href="favicon.ico" rel="SHORTCUT ICON" />
<link href="screen.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table class="oratorHeader" border="0" cellspacing="0" cellpadding="1" width="100%"><tr>
<td width="1%" align="left" class="oratorHeaderBack" valign="center" nowrap="nowrap"><a href="56_step7d.xml.html" onmouseout="window.status='';" onmouseover="window.status='Go to: VFS'; return true;" accesskey="P"><img src="presentation_back.png" alt="Back" title="Back" /></a></td><td style="cursor: hand;" onclick="location.href='56_step7d.xml.html';" align="left" class="oratorHeaderBack" width="24%"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitleHigh">VFS</div></td></tr></table></td>
<td width="50%" align="center" style="cursor: hand;" class="oratorHeaderBack" valign="center" nowrap="nowrap" onclick="if (document.getElementById('title').style.display=='none'){document.getElementById('slides').style.display='none';document.getElementById('title').style.display='inline';}else{document.getElementById('title').style.display='none';document.getElementById('slides').style.display='inline';}" ondblclick="location.href='57_step7e.xml.html';"><select id="slides" style="display:none" onchange="location.href=this.options[this.selectedIndex].value"><option value="0_title.xml.html">Welcome</option><option value="1_horde1a.xml.html">What is Horde?</option><option value="2_horde1b.xml.html">What is Horde?</option><option value="3_horde1c.xml.html">What is Horde?</option><option value="4_horde1d.xml.html">What is Horde?</option><option value="5_horde1e.xml.html">What is Horde?</option><option value="6_history1.xml.html">History</option><option value="7_history2.xml.html">History</option><option value="8_history3.xml.html">History</option><option value="9_history4.xml.html">History</option><option value="10_horde2a.xml.html">Numbers and Buzz Words</option><option value="11_horde2b.xml.html">Numbers and Buzz Words</option><option value="12_horde2c.xml.html">Numbers and Buzz Words</option><option value="13_horde2d.xml.html">Numbers and Buzz Words</option><option value="14_horde2e.xml.html">Numbers and Buzz Words</option><option value="15_horde2f.xml.html">Numbers and Buzz Words</option><option value="16_horde2g.xml.html">Numbers and Buzz Words</option><option value="17_goal1.xml.html">Today's Goal</option><option value="18_goal2.xml.html">Today's Goal</option><option value="19_goal3.xml.html">Today's Goal</option><option value="20_skeleton.xml.html">Application structure</option><option value="21_step1a.xml.html">Creating the Skeleton</option><option value="22_step1b.xml.html">Creating the Skeleton</option><option value="23_step1c.xml.html">Creating the Skeleton</option><option value="24_step1d.xml.html">Creating the Skeleton</option><option value="25_step1e.xml.html">Creating the Skeleton</option><option value="26_step1f.xml.html">Creating the Skeleton</option><option value="27_step1g.xml.html">Creating the Skeleton</option><option value="28_step1h.xml.html">Creating the Skeleton</option><option value="29_step2a.xml.html">Database Structure</option><option value="30_step2b.xml.html">Database Structure</option><option value="31_step2c.xml.html">Database Structure</option><option value="32_step2d.xml.html">Database Structure</option><option value="33_step3a.xml.html">Database Access</option><option value="34_step3b.xml.html">Database Access</option><option value="35_step3c.xml.html">Database Access</option><option value="36_step4a.xml.html">Forms</option><option value="37_step4b.xml.html">Forms</option><option value="38_step4c.xml.html">Forms</option><option value="39_step4d.xml.html">Forms</option><option value="40_step4e.xml.html">Forms</option><option value="41_step4f.xml.html">Forms</option><option value="42_step4g.xml.html">Forms</option><option value="43_step4h.xml.html">Forms</option><option value="44_step4i.xml.html">Forms</option><option value="45_step4j.xml.html">Forms</option><option value="46_step4k.xml.html">Forms</option><option value="47_step5a.xml.html">Templates</option><option value="48_step5b.xml.html">Templates</option><option value="49_step6a.xml.html">Forms II</option><option value="50_step6b.xml.html">Forms II</option><option value="51_step6c.xml.html">Forms II</option><option value="52_step6d.xml.html">Forms II</option><option value="53_step7a.xml.html">VFS</option><option value="54_step7b.xml.html">VFS</option><option value="55_step7c.xml.html">VFS</option><option value="56_step7d.xml.html">VFS</option><option value="57_step7e.xml.html" selected="selected">VFS</option><option value="58_step7f.xml.html">VFS</option><option value="59_step7g.xml.html">VFS</option><option value="60_author.xml.html">Credits</option><option value="61_todo.xml.html">Outlook</option><option value="62_resources.xml.html">Resources</option><option value="63_questions.xml.html">Questions</option><option value="64_thanks.xml.html">Thank You</option></select><span id="title"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitle">VFS</div></td></tr></table></span></td>
<td style="cursor: hand;" onclick="location.href='58_step7f.xml.html';"width="24%" align="right" class="oratorHeaderBack" valign="center" nowrap="nowrap"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitleHigh">VFS</div></td></tr></table></td><td width="1%" align="right"><a href="58_step7f.xml.html" onmouseout="window.status='';" onmouseover="window.status='Go to: VFS'; return true;" accesskey="N"><img src="presentation_forward.png" alt="Forward" title="Forward" /></a></td>
</tr></table>
<br /><br /><div align="center">
<table border="0" width="90%"><tr><td align="left">

  <div align="center" class="osHeading">Step 7: File Uploads and Virtual File Storage</div>

  <p>Adding two more fields to the form:</p>

  <code><font color="#000000">
<br /><font color="#0000BB">&lt;?php<br /><br />lib</font><font color="#007700">/</font><font color="#0000BB">MP3Form</font><font color="#007700">.</font><font color="#0000BB">php</font><font color="#007700">:<br /><br />function </font><font color="#0000BB">MP3_Form</font><font color="#007700">(&amp;</font><font color="#0000BB">$vars</font><font color="#007700">, </font><font color="#0000BB">$title </font><font color="#007700">= </font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#0000BB">$edit </font><font color="#007700">= </font><font color="#0000BB">true</font><font color="#007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">parent</font><font color="#007700">::</font><font color="#0000BB">Horde_Form</font><font color="#007700">(</font><font color="#0000BB">$vars</font><font color="#007700">, </font><font color="#0000BB">$title</font><font color="#007700">, </font><font color="#DD0000">'mp3_form'</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addHidden</font><font color="#007700">(</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#DD0000">'id'</font><font color="#007700">, </font><font color="#DD0000">'int'</font><font color="#007700">, </font><font color="#0000BB">false</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Title"</font><font color="#007700">), </font><font color="#DD0000">'song_title'</font><font color="#007700">, </font><font color="#DD0000">'text'</font><font color="#007700">, </font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Artist"</font><font color="#007700">), </font><font color="#DD0000">'song_artist'</font><font color="#007700">, </font><font color="#DD0000">'text'</font><font color="#007700">, </font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Album"</font><font color="#007700">), </font><font color="#DD0000">'song_album'</font><font color="#007700">, </font><font color="#DD0000">'text'</font><font color="#007700">, </font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Add fields depending on active/inactive rendering. */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if (</font><font color="#0000BB">$edit</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"MP3 file"</font><font color="#007700">), </font><font color="#DD0000">'file'</font><font color="#007700">, </font><font color="#DD0000">'file'</font><font color="#007700">, </font><font color="#0000BB">false</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"MP3 ID tags"</font><font color="#007700">), </font><font color="#DD0000">'song_idtag'</font><font color="#007700">, </font><font color="#DD0000">'html'</font><font color="#007700">, </font><font color="#0000BB">false</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">addVariable</font><font color="#007700">(</font><font color="#DD0000">''</font><font color="#007700">, </font><font color="#DD0000">'sound'</font><font color="#007700">, </font><font color="#DD0000">'html'</font><font color="#007700">, </font><font color="#0000BB">false</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></font><font color="#0000BB">mp3</font><font color="#007700">.</font><font color="#0000BB">php</font><font color="#007700">:<br /><br /></font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">'song_idtag'</font><font color="#007700">, </font><font color="#0000BB">Mopple</font><font color="#007700">::</font><font color="#0000BB">tagsToHTML</font><font color="#007700">(</font><font color="#0000BB">$mp3</font><font color="#007700">[</font><font color="#DD0000">'song_idtag'</font><font color="#007700">]));<br /></font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">'sound'</font><font color="#007700">, </font><font color="#0000BB">Mopple</font><font color="#007700">::</font><font color="#0000BB">playerHTML</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">));<br /><br /></font><font color="#0000BB">$form </font><font color="#007700">= &amp;new </font><font color="#0000BB">MP3_Form</font><font color="#007700">(</font><font color="#0000BB">$variables</font><font color="#007700">, </font><font color="#0000BB">$title</font><font color="#007700">, </font><font color="#0000BB">false</font><font color="#007700">);<br /></font><font color="#0000BB">$edit_url </font><font color="#007700">= </font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">applicationUrl</font><font color="#007700">(</font><font color="#DD0000">'edit.php'</font><font color="#007700">);<br /></font><font color="#0000BB">$edit_url </font><font color="#007700">= </font><font color="#0000BB">Util</font><font color="#007700">::</font><font color="#0000BB">addParameter</font><font color="#007700">(</font><font color="#0000BB">$edit_url</font><font color="#007700">, array(</font><font color="#DD0000">'id' </font><font color="#007700">=&gt; </font><font color="#0000BB">$mp3</font><font color="#007700">[</font><font color="#DD0000">'song_id'</font><font color="#007700">]));<br /></font><font color="#0000BB">$edit_link </font><font color="#007700">= </font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">link</font><font color="#007700">(</font><font color="#0000BB">$edit_url</font><font color="#007700">, </font><font color="#0000BB">sprintf</font><font color="#007700">(</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Edit \"%s\""</font><font color="#007700">), </font><font color="#0000BB">$title</font><font color="#007700">), </font><font color="#DD0000">'smallheader'</font><font color="#007700">);<br /></font><font color="#0000BB">$form</font><font color="#007700">-&gt;</font><font color="#0000BB">setExtra</font><font color="#007700">(</font><font color="#0000BB">$edit_link </font><font color="#007700">. </font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Edit"</font><font color="#007700">) . </font><font color="#DD0000">'&lt;/a&gt;'</font><font color="#007700">);<br /></font><font color="#0000BB">$renderer </font><font color="#007700">= &amp;</font><font color="#0000BB">$form</font><font color="#007700">-&gt;</font><font color="#0000BB">getRenderer</font><font color="#007700">();<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code><br />



</td></tr></table></div>
</body>
</html>
